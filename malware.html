<!-- Sezione Malware Analysis -->
<div class="section-container malware-analysis">
    <div class="section-header">
        <h2>Analisi Malware</h2>
        <p class="lead">Tecniche e strumenti per l'analisi dei malware</p>
    </div>

    <!-- Tabs di navigazione -->
    <ul class="nav nav-tabs" id="malwareTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="statica-tab" data-bs-toggle="tab" data-bs-target="#statica" type="button" role="tab">Analisi Statica</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="dinamica-tab" data-bs-toggle="tab" data-bs-target="#dinamica" type="button" role="tab">Analisi Dinamica <span class="badge bg-warning text-dark ms-1">In sviluppo</span></button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="statica-avanzata-tab" data-bs-toggle="tab" data-bs-target="#statica-avanzata" type="button" role="tab">Analisi Statica Avanzata <span class="badge bg-warning text-dark ms-1">In sviluppo</span></button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="dinamica-avanzata-tab" data-bs-toggle="tab" data-bs-target="#dinamica-avanzata" type="button" role="tab">Analisi Dinamica Avanzata <span class="badge bg-warning text-dark ms-1">In sviluppo</span></button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="excel-tab" data-bs-toggle="tab" data-bs-target="#excel" type="button" role="tab">Analisi File Excel</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="word-tab" data-bs-toggle="tab" data-bs-target="#word" type="button" role="tab">Analisi File Word</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="pdf-tab" data-bs-toggle="tab" data-bs-target="#pdf" type="button" role="tab">Analisi File PDF</button>
        </li>
    </ul>

    <!-- Contenuti dei tab -->
    <div class="tab-content" id="malwareTabContent">
        <!-- Analisi Statica -->
        <div class="tab-pane fade show active" id="statica" role="tabpanel">
            <div class="container mt-4">
                <h3>Analisi Statica del Malware</h3>
                <p>L'analisi statica consiste nell'esaminare un file sospetto senza eseguirlo, utilizzando vari strumenti per raccogliere informazioni sul suo comportamento potenziale.</p>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h4>Raccolta Informazioni (Metadata Analysis)</h4>
                    </div>
                    <div class="card-body">
                        <ol>
                            <li>
                                <strong>Identificazione del tipo di file</strong>:
                                <ul>
                                    <li>Esegui il comando <code>file &lt;documento&gt;</code> per verificare l'effettiva estensione e integrità del file.</li>
                                    <li>Usa <code>exiftool &lt;documento&gt;</code> per analizzare i metadati (autore, timestamp, software di creazione).</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Hashing e identificazione</strong>:
                                <ul>
                                    <li>Calcola l'hash del file con <code>sha256sum &lt;documento&gt;</code> per identificazioni successive.</li>
                                    <li>Verifica su <strong>VirusTotal</strong>, <strong>Malshare</strong> o <strong>Hybrid Analysis</strong> per indicatori noti.</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header">
                        <h4>Passi dell'Analisi Statica</h4>
                    </div>
                    <div class="card-body">
                        <ol>
                            <li>
                                <strong>Calcolare l'hash del file</strong>
                                <pre><code class="language-bash">Certutil -hashfile file.exe SHA256   # Per CMD Windows
sha256sum file.exe                 # Per Linux</code></pre>
                            </li>
                            
                            <li>
                                <strong>Caricare l'hash su VirusTotal</strong>
                                <p>Campi importanti da analizzare:</p>
                                <ul>
                                    <li><strong>File Type:</strong> Identifica se è un eseguibile, script, documento, ecc.</li>
                                    <li><strong>File Size:</strong> Indica se è un payload complesso o un semplice dropper.</li>
                                    <li><strong>Compilation Date:</strong> Verifica se è coerente con la versione del software.</li>
                                    <li><strong>Packer/Protector:</strong> Controlla se è offuscato o protetto da un packer.</li>
                                    <li><strong>Import Table:</strong> Verifica le librerie utilizzate.</li>
                                    <li><strong>Sections:</strong> Osserva nomi sospetti o dimensioni anomale.</li>
                                    <li><strong>Digital Signature:</strong> Se presente, verifica l'attendibilità.</li>
                                </ul>
                            </li>
                            
                            <li>
                                <strong>Analisi delle stringhe</strong>
                                <pre><code class="language-bash">strings file.exe
floss file.exe   # FLOSS rileva anche stringhe offuscate</code></pre>
                                <p>FLOSS è un'evoluzione di strings, oltre alle stringhe in chiaro, <strong>rileva e decodifica stringhe offuscate o criptate</strong> che normalmente non sarebbero visibili con strings.</p>
                                
                                <div class="text-center my-4">
                                    <a href="attached_assets/Pasted image 20250517124433.png" target="_blank" class="image-link">
                                        <img src="attached_assets/Pasted image 20250517124433.png" alt="Esempio di output del comando FLOSS" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                                        <div class="overlay"><i class="fas fa-search-plus"></i></div>
                                    </a>
                                    <p class="text-muted mt-2"><small>Esempio di output del comando FLOSS che mostra stringhe estratte da un malware</small></p>
                                </div>
                            </li>
                            
                            <li>
                                <strong>Analizzare la tabella di import address con PEView</strong>
                                <p>Le <strong>Section</strong> rappresentano diverse aree di memoria utilizzate dal programma:</p>
                                <ul>
                                    <li><strong>.text</strong> - Contiene il codice eseguibile (le istruzioni del programma)</li>
                                    <li><strong>.data</strong> - Area di memoria che contiene dati globali e variabili statiche</li>
                                    <li><strong>.rdata</strong> - Contiene dati di sola lettura, come le stringhe costanti e le Import Table</li>
                                    <li><strong>.bss</strong> - Sezione non inizializzata, usata per variabili globali non inizializzate</li>
                                    <li><strong>.idata</strong> - Contiene la Import Table, con le librerie e le funzioni importate</li>
                                    <li><strong>.rsrc</strong> - Contiene le risorse del programma, come icone, immagini, menu</li>
                                </ul>
                                
                                <div class="text-center my-4">
                                    <a href="attached_assets/Pasted image 20250517124546.png" target="_blank" class="image-link">
                                        <img src="attached_assets/Pasted image 20250517124546.png" alt="PEView - Sezioni di un file PE" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                                        <div class="overlay"><i class="fas fa-search-plus"></i></div>
                                    </a>
                                    <p class="text-muted mt-2"><small>PEView mostrando le sezioni di un file PE (Portable Executable)</small></p>
                                </div>
                                
                                <div class="text-center my-4">
                                    <a href="attached_assets/Pasted image 20250517124609.png" target="_blank" class="image-link">
                                        <img src="attached_assets/Pasted image 20250517124609.png" alt="PEView - Import Table" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                                        <div class="overlay"><i class="fas fa-search-plus"></i></div>
                                    </a>
                                    <p class="text-muted mt-2"><small>PEView mostrando la Import Table con funzioni sospette</small></p>
                                </div>
                            </li>
                        </ol>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header">
                        <h4>Come capire se un malware è packed?</h4>
                    </div>
                    <div class="card-body">
                        <p>Il packing nasconde il codice reale del malware rendendo difficile l'analisi con strumenti automatici. Il file appare "incomprensibile" finché non viene eseguito e decompresso in memoria.</p>
                        
                        <h5>Indicatori di packing:</h5>
                        <ul>
                            <li>Se il <strong>Virtual Size</strong> (la dimensione in memoria) è molto più grande del <strong>Size of Raw Data</strong> (la dimensione sul disco)</li>
                            <li>Poche o nessuna funzione importata visibile</li>
                            <li>Sezioni con nomi come <code>.upx</code>, <code>.packed</code>, <code>.crypt</code>, o nomi non standard</li>
                        </ul>
                        
                        <p>Software come <strong>PEiD</strong>, <strong>Detect It Easy (DIE)</strong>, <strong>Exeinfo PE</strong> o <strong>PE-bear</strong> identificano automaticamente se un file è packed e quale packer viene utilizzato.</p>
                        
                        <div class="text-center my-4">
                            <a href="attached_assets/Pasted image 20250517124908.png" target="_blank" class="image-link">
                                <img src="attached_assets/Pasted image 20250517124908.png" alt="Detect It Easy mostrando un malware packed" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                                <div class="overlay"><i class="fas fa-search-plus"></i></div>
                            </a>
                            <p class="text-muted mt-2"><small>Detect It Easy (DIE) che rileva un malware packed con UPX</small></p>
                        </div>
                        
                        <div class="text-center my-4">
                            <a href="attached_assets/Pasted image 20250517124939.png" target="_blank" class="image-link">
                                <img src="attached_assets/Pasted image 20250517124939.png" alt="Hexdump di un file packed" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                                <div class="overlay"><i class="fas fa-search-plus"></i></div>
                            </a>
                            <p class="text-muted mt-2"><small>Visione del contenuto esadecimale di un file packed - si noti la compressione evidente</small></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analisi Dinamica -->
        <div class="tab-pane fade" id="dinamica" role="tabpanel">
            <div class="container mt-4">
                <div class="alert alert-warning mb-4">
                    <h4 class="alert-heading"><i class="fas fa-tools me-2"></i>Sezione in sviluppo</h4>
                    <p class="mb-0">Questa sezione è attualmente in fase di sviluppo. Presto saranno disponibili contenuti dettagliati sull'analisi dinamica del malware, includendo:</p>
                    <ul class="mb-0 mt-2">
                        <li>Configurazione di ambienti sicuri per l'analisi</li>
                        <li>Strumenti di monitoraggio del sistema</li>
                        <li>Analisi del comportamento di rete</li>
                        <li>Tecniche di sandboxing</li>
                    </ul>
                </div>
                
                <h3>Analisi Dinamica del Malware</h3>
                <p>L'analisi dinamica consiste nell'eseguire il malware in un ambiente controllato (sandbox) per osservarne il comportamento reale.</p>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h4>Preparazione dell'ambiente</h4>
                    </div>
                    <div class="card-body">
                        <ol>
                            <li>
                                <strong>Creare una macchina virtuale isolata</strong>
                                <p>Preferibilmente usando software come VirtualBox o VMware con snapshot abilitati</p>
                            </li>
                            <li>
                                <strong>Disabilitare la connessione di rete</strong>
                                <p>A meno che non sia necessario per l'analisi, in tal caso utilizzare una rete isolata</p>
                            </li>
                            <li>
                                <strong>Installare strumenti di monitoraggio</strong>
                                <ul>
                                    <li>Process Monitor (ProcMon) - per monitorare l'attività del filesystem, registro e processi</li>
                                    <li>Process Explorer - per visualizzare processi attivi e le loro dipendenze</li>
                                    <li>Wireshark - per monitorare il traffico di rete (solo se necessario)</li>
                                    <li>RegShot - per catturare e confrontare i cambiamenti al registro di sistema</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analisi Statica Avanzata -->
        <div class="tab-pane fade" id="statica-avanzata" role="tabpanel">
            <div class="container mt-4">
                <div class="alert alert-warning mb-4">
                    <h4 class="alert-heading"><i class="fas fa-tools me-2"></i>Sezione in sviluppo</h4>
                    <p class="mb-0">Questa sezione è attualmente in fase di sviluppo. Presto saranno disponibili contenuti dettagliati sull'analisi statica avanzata, includendo:</p>
                    <ul class="mb-0 mt-2">
                        <li>Disassembling di file eseguibili</li>
                        <li>Analisi di codice Assembly</li>
                        <li>Ricostruzione del Control Flow Graph</li>
                        <li>Tecniche di deobfuscation</li>
                        <li>Analisi avanzata dei compilatori e packer</li>
                    </ul>
                </div>
                
                <h3>Analisi Statica Avanzata</h3>
                <p>L'analisi statica avanzata implica l'uso di disassemblatori e decompilatori per esaminare il codice macchina e comprendere le funzionalità del malware senza eseguirlo.</p>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h4>Strumenti per l'analisi statica avanzata</h4>
                    </div>
                    <div class="card-body">
                        <ul>
                            <li>
                                <strong>IDA Pro / Ghidra</strong>
                                <p>Strumenti avanzati di disassembling e decompilazione che permettono di analizzare il codice assembly del malware.</p>
                            </li>
                            <li>
                                <strong>Radare2</strong>
                                <p>Framework open source per l'analisi forense e il reverse engineering.</p>
                            </li>
                            <li>
                                <strong>Binary Ninja</strong>
                                <p>Piattaforma moderna per l'analisi binaria interattiva.</p>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analisi Dinamica Avanzata -->
        <div class="tab-pane fade" id="dinamica-avanzata" role="tabpanel">
            <div class="container mt-4">
                <div class="alert alert-warning mb-4">
                    <h4 class="alert-heading"><i class="fas fa-tools me-2"></i>Sezione in sviluppo</h4>
                    <p class="mb-0">Questa sezione è attualmente in fase di sviluppo. Presto saranno disponibili contenuti dettagliati sull'analisi dinamica avanzata, includendo:</p>
                    <ul class="mb-0 mt-2">
                        <li>Analisi delle API utilizzate durante l'esecuzione</li>
                        <li>Tecniche di memory forensics</li>
                        <li>Hooking e patching di API per eludere meccanismi anti-analisi</li>
                        <li>Configurazione di ambienti "realistici" per ingannare meccanismi anti-VM</li>
                        <li>Analisi avanzata del traffico di rete malware</li>
                    </ul>
                </div>
                
                <h3>Analisi Dinamica Avanzata</h3>
                <p>L'analisi dinamica avanzata prevede tecniche sofisticate per monitorare e comprendere il comportamento del malware durante l'esecuzione, superando le comuni tecniche anti-analisi.</p>
            </div>
        </div>

        <!-- Analisi File Excel -->
        <div class="tab-pane fade" id="excel" role="tabpanel">
            <div class="container mt-4">
                <h3>Analisi dei File Excel Malevoli</h3>
                <p>I file Excel possono contenere macro VBA malevole o altri meccanismi per eseguire codice dannoso. Ecco come analizzarli in sicurezza.</p>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h4>Analisi di File Excel (.xlsm)</h4>
                    </div>
                    <div class="card-body">
                        <ol>
                            <li>
                                <strong>Estrazione del contenuto</strong>
                                <pre><code class="language-bash">unzip file.xlsm</code></pre>
                                <p>Dentro vedrai cartelle come:</p>
                                <ul>
                                    <li><code>xl/</code> — contiene fogli di lavoro, macro (<code>vbaProject.bin</code>), e altro</li>
                                    <li><code>docProps/</code> — proprietà del documento</li>
                                    <li><code>_rels/</code> — file di relazioni tra componenti</li>
                                    <li><code>[Content_Types].xml</code> — informazioni sul tipo di contenuto</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Analisi delle macro con oledump</strong>
                                <pre><code class="language-bash">oledump.py file.xlsm</code></pre>
                                
                                <div class="text-center my-4">
                                    <a href="attached_assets/Pasted image 20250517165025.png" target="_blank" class="image-link">
                                        <img src="attached_assets/Pasted image 20250517165025.png" alt="Output di oledump su file Excel" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                                        <div class="overlay"><i class="fas fa-search-plus"></i></div>
                                    </a>
                                    <p class="text-muted mt-2"><small>Output di oledump mostrando i moduli VBA presenti in un file Excel sospetto</small></p>
                                </div>
                                
                                <p>La <strong>M</strong> indica un <strong>modulo standard</strong> VBA, cioè un modulo contenente codice VBA scritto dall'utente che non è legato a un particolare oggetto.</p>
                                <p>La <strong>m</strong> indica un <strong>modulo di classe o modulo oggetto</strong>, ovvero un modulo VBA associato a un oggetto specifico nel file Excel, come il workbook stesso (<code>ThisWorkbook</code>).</p>
                            </li>
                            <li>
                                <strong>Visualizzazione del contenuto del modulo</strong>
                                <pre><code class="language-bash">oledump.py -s 4 sampleExcelFile.xlsm    # Visualizza il modulo numero 4</code></pre>
                                
                                <div class="text-center my-4">
                                    <a href="attached_assets/Pasted image 20250517165118.png" target="_blank" class="image-link">
                                        <img src="attached_assets/Pasted image 20250517165118.png" alt="Output di oledump mostrando contenuto VBA" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                                        <div class="overlay"><i class="fas fa-search-plus"></i></div>
                                    </a>
                                    <p class="text-muted mt-2"><small>Dump esadecimale del contenuto del modulo che mostra potenziale codice malevolo</small></p>
                                </div>
                            </li>
                            <li>
                                <strong>Analisi delle stringhe del modulo</strong>
                                <pre><code class="language-bash">oledump.py -s 4 -S sampleExcelFile.xlsm    # Mostra solo le stringhe del modulo</code></pre>
                                
                                <div class="text-center my-4">
                                    <a href="attached_assets/Pasted image 20250517165136.png" target="_blank" class="image-link">
                                        <img src="attached_assets/Pasted image 20250517165136.png" alt="Output di oledump mostrando stringhe VBA" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                                        <div class="overlay"><i class="fas fa-search-plus"></i></div>
                                    </a>
                                    <p class="text-muted mt-2"><small>Stringhe estratte dal modulo VBA che mostrano comandi sospetti incluso un download di file eseguibile</small></p>
                                </div>
                            </li>
                            <li>
                                <strong>Decompressione di moduli VBA corrotti</strong>
                                <pre><code class="language-bash">oledump.py -s 4 --vbadecompresscorrupt sampleExcelFile.xlsm</code></pre>
                                <p>L'opzione <code>--vbadecompresscorrupt</code> serve per decomprimere moduli VBA corrotti o danneggiati.</p>
                                
                                <div class="text-center my-4">
                                    <a href="attached_assets/Pasted image 20250517165206.png" target="_blank" class="image-link">
                                        <img src="attached_assets/Pasted image 20250517165206.png" alt="Risultato della decompressione di VBA corrotto" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                                        <div class="overlay"><i class="fas fa-search-plus"></i></div>
                                    </a>
                                    <p class="text-muted mt-2"><small>Risultato della decompressione di un modulo VBA corrotto che mostra codice malevolo completo con download di eseguibile</small></p>
                                </div>
                            </li>
                        </ol>
                        
                        <div class="alert alert-warning bg-warning text-dark">
                            <h5 class="alert-heading fw-bold"><i class="fas fa-exclamation-triangle me-2"></i>Attenzione: Rischio template remoti</h5>
                            <p class="mb-0">Un file Excel <code class="bg-dark text-white px-1">.xlsx</code> o <code class="bg-dark text-white px-1">.xlsm</code> può puntare a un template esterno di tipo <code class="bg-dark text-white px-1">.xltm</code>. Questo template può essere caricato da un percorso remoto e, se compromesso, può eseguire macro malevole all'apertura.</p>
                        </div>
                    </div>
                </div>
                
                <div class="card mb-4 border-primary">
                    <div class="card-header bg-primary text-white">
                        <h4 class="mb-0"><i class="fas fa-clipboard-check me-2"></i>Playbook di Analisi Excel</h4>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5 class="border-bottom pb-2">Raccolta Informazioni</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item border-0 ps-0">
                                        <strong>Identificazione del tipo di file:</strong>
                                        <ul>
                                            <li><code>file &lt;documento&gt;</code> → Verifica estensione e integrità</li>
                                            <li><code>exiftool &lt;documento&gt;</code> → Analisi dei metadati</li>
                                        </ul>
                                    </li>
                                    <li class="list-group-item border-0 ps-0">
                                        <strong>Hashing e identificazione:</strong>
                                        <ul>
                                            <li><code>sha256sum &lt;documento&gt;</code> → Calcolo dell'hash</li>
                                            <li>Verifica su VirusTotal, Malshare, Hybrid Analysis</li>
                                        </ul>
                                    </li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h5 class="border-bottom pb-2">Analisi Statica Excel</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item border-0 ps-0">
                                        <code>olevba &lt;documento.xlsm&gt;</code> → Estrazione di macro VBA
                                    </li>
                                    <li class="list-group-item border-0 ps-0">
                                        <code>oledump.py &lt;documento.xls&gt;</code> → Macro e oggetti nascosti
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analisi File Word -->
        <div class="tab-pane fade" id="word" role="tabpanel">
            <div class="container mt-4">
                <h3>Analisi dei File Word Malevoli</h3>
                <p>I documenti Word possono nascondere macro, exploit o collegamenti a contenuti dannosi. Ecco le tecniche per analizzarli in sicurezza.</p>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h4>Tipi di file e rischi associati</h4>
                    </div>
                    <div class="card-body">
                        <p>Per quanto riguarda i documenti Word, esistono due estensioni principali: <strong>.docx</strong> e <strong>.docm</strong>.</p>
                        
                        <ul>
                            <li>I file <strong>.docx</strong> non possono contenere macro VBA direttamente, essendo un formato "macro-free". Tuttavia, un documento <code>.docx</code> può fare riferimento a un template esterno <strong>.dotm</strong> che include macro, permettendo l'esecuzione di codice VBA.</li>
                            <li>Il formato <strong>.docm</strong>, invece, supporta direttamente macro VBA integrate nel file. Questa differenza è importante per riconoscere potenziali rischi di sicurezza legati ai documenti Word.</li>
                        </ul>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h4>Analisi di File DOCM (con macro)</h4>
                    </div>
                    <div class="card-body">
                        <p>Per analizzare le macro VBA o contenuti malevoli presenti in un file <code>.docm</code>, puoi utilizzare il comando:</p>
                        
                        <pre><code class="language-bash">oledump.py file.docm</code></pre>
                        
                        <p>Questo permette di identificare eventuali flussi VBA all'interno del documento.</p>
                        
                        <div class="text-center my-4">
                            <img src="attached_assets/Pasted image 20250517160802.png" alt="Analisi di file Word con oledump" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                        </div>
                        
                        <p>Se vuoi visualizzare il contenuto di un modulo VBA specifico (ad esempio, il flusso 3) e filtrare solo le stringhe leggibili:</p>
                        
                        <pre><code class="language-bash">oledump.py -s 3 -S 7085f3dda26b773120d4da2362f5a2e95af799dcec8ec580d36c9d77a6abda4d.docm</code></pre>
                        
                        <div class="text-center my-4">
                            <img src="attached_assets/Pasted image 20250517160904.png" alt="Contenuto VBA estratto da un file Word malevolo" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                        </div>
                        
                        <p><strong><code>--vbadecompresscorrupt</code></strong>: è un'opzione avanzata di oledump.py che serve per <strong>decomprimere moduli VBA corrotti o danneggiati</strong>.</p>
                        
                        <pre><code class="language-bash">oledump.py -s 3 --vbadecompresscorrupt 7085f3dda26b773120d4da2362f5a2e95af799dcec8ec580d36c9d77a6abda4d.docm</code></pre>
                        
                        <div class="text-center my-4">
                            <img src="attached_assets/Pasted image 20250517161030.png" alt="Decompressione di moduli VBA corrotti" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                        </div>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h4>Analisi di File DOC</h4>
                    </div>
                    <div class="card-body">
                        <p>Come spiegato all'inizio, i file <code>.doc</code> non mostrano macro direttamente tramite <code>oledump.py</code>.</p>
                        
                        <div class="text-center my-4">
                            <img src="attached_assets/Pasted image 20250517162502.png" alt="Analisi di file Word con oledump" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                        </div>
                        
                        <p>Come si analizza un file doc:</p>
                        <ol class="mb-0">
                            <li><strong>Rinomina l'estensione del file</strong> da <code>.doc</code> a <code>.zip</code>.</li>
                            <li><strong>Apri l'archivio</strong> <code>.zip</code>.
                                <div class="text-center my-3">
                                    <a href="attached_assets/Pasted image 20250517162624.png" target="_blank" class="image-link">
                                        <img src="attached_assets/Pasted image 20250517162624.png" alt="Contenuto dell'archivio zip" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                                        <div class="overlay"><i class="fas fa-search-plus"></i></div>
                                    </a>
                                    <p class="text-muted mt-2"><small>Contenuto dell'archivio zip estratto dal file DOC</small></p>
                                </div>
                            </li>
                            <li><strong>Naviga nella directory</strong> <code>word -> rels</code>.
                                <div class="text-center my-3">
                                    <a href="attached_assets/Pasted image 20250517162753.png" target="_blank" class="image-link">
                                        <img src="attached_assets/Pasted image 20250517162753.png" alt="Navigazione directory rels" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                                        <div class="overlay"><i class="fas fa-search-plus"></i></div>
                                    </a>
                                    <p class="text-muted mt-2"><small>Struttura della directory rels nel file DOC</small></p>
                                </div>
                            </li>
                            <li><strong>Nel file <code>settings.xml.rels</code></strong>, trova l'indirizzo del template remoto.
                                <div class="text-center my-3">
                                    <a href="attached_assets/Pasted image 20250517162955.png" target="_blank" class="image-link">
                                        <img src="attached_assets/Pasted image 20250517162955.png" alt="Template remoto URL" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                                        <div class="overlay"><i class="fas fa-search-plus"></i></div>
                                    </a>
                                    <p class="text-muted mt-2"><small>File di relazioni contenente l'URL malevolo</small></p>
                                </div>
                            </li>
                            <li><strong>Analizza l'URL presente nel target</strong> per identificare eventuali template malevoli.
                                <div class="text-center my-3">
                                    <a href="attached_assets/Pasted image 20250517163547.png" target="_blank" class="image-link">
                                        <img src="attached_assets/Pasted image 20250517163547.png" alt="Sito malevolo" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                                        <div class="overlay"><i class="fas fa-search-plus"></i></div>
                                    </a>
                                    <p class="text-muted mt-2"><small>Sito malevolo a cui punta il template remoto</small></p>
                                </div>
                            </li>
                        </ol>
                    </div>
                </div>
                
                <div class="card mb-4 border-primary">
                    <div class="card-header bg-primary text-white">
                        <h4 class="mb-0"><i class="fas fa-clipboard-check me-2"></i>Playbook di Analisi Word</h4>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5 class="border-bottom pb-2">Raccolta Informazioni</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item border-0 ps-0">
                                        <strong>Identificazione del tipo di file:</strong>
                                        <ul>
                                            <li><code>file &lt;documento&gt;</code> → Verifica estensione e integrità</li>
                                            <li><code>exiftool &lt;documento&gt;</code> → Analisi dei metadati</li>
                                        </ul>
                                    </li>
                                    <li class="list-group-item border-0 ps-0">
                                        <strong>Hashing e identificazione:</strong>
                                        <ul>
                                            <li><code>sha256sum &lt;documento&gt;</code> → Calcolo dell'hash</li>
                                            <li>Verifica su VirusTotal, Malshare, Hybrid Analysis</li>
                                        </ul>
                                    </li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h5 class="border-bottom pb-2">Analisi Statica Word</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item border-0 ps-0">
                                        <code>olevba &lt;documento.docm&gt;</code> → Estrazione di macro VBA
                                    </li>
                                    <li class="list-group-item border-0 ps-0">
                                        <code>oledump.py &lt;documento.doc&gt;</code> → Macro e oggetti nascosti
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analisi File PDF -->
        <div class="tab-pane fade" id="pdf" role="tabpanel">
            <div class="container mt-4">
                <h3>Analisi dei File PDF Malevoli</h3>
                <p>I file PDF possono contenere JavaScript dannoso, exploit o altri payload. Ecco come analizzarli in sicurezza.</p>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h4>Analisi con peepdf</h4>
                    </div>
                    <div class="card-body">
                        <pre><code class="language-bash">python2 peepdf.py a2852936a7e33787c0ab11f346631d89.pdf</code></pre>
                        <p>Questo comando mostra la struttura del PDF e gli oggetti contenuti, come eventuali script JavaScript malevoli.</p>
                        
                        <div class="text-center my-4">
                            <img src="attached_assets/Pasted image 20250517171133.png" alt="Output del comando peepdf" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                            <p class="text-muted mt-2"><small>Esempio di output del comando peepdf che mostra la struttura di un PDF malevolo con oggetti JavaScript sospetti</small></p>
                        </div>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h4>Estrazione e analisi di oggetti specifici</h4>
                    </div>
                    <div class="card-body">
                        <p>Per estrarre e analizzare il contenuto di uno specifico oggetto, ad esempio l'oggetto numero 18 che contiene codice JavaScript, si usa <code>pdf-parser</code> con questi parametri:</p>
                        
                        <pre><code class="language-bash">pdf-parser -o 18 -d codec.js a2852936a7e33787c0ab11f346631d89.pdf</code></pre>
                        
                        <ul class="mt-3">
                            <li><code>-o 18</code>: indica l'<strong>oggetto</strong> del PDF da estrarre, in questo caso l'oggetto numero 18, che corrisponde al codice JavaScript sospetto.</li>
                            <li><code>-d codec.js</code>: specifica il <strong>nome del file</strong> dove verrà salvato il contenuto estratto (il codice JavaScript in chiaro).</li>
                            <li><code>-f</code>: applica i <strong>filtri di decompressione</strong> per decodificare il contenuto (ad esempio FlateDecode, ASCIIHexDecode, ASCII85Decode, LZWDecode, RunLengthDecode), in modo da ottenere il codice leggibile e non compresso.</li>
                        </ul>
                        
                        <div class="text-center my-4">
                            <img src="attached_assets/Pasted image 20250517171645.png" alt="Esempio di estrazione e analisi di JavaScript in un PDF" class="img-fluid border rounded shadow-sm" style="max-width: 90%;">
                            <p class="text-muted mt-2"><small>Esempio di estrazione e analisi di un oggetto JavaScript in un PDF malevolo che mostra un tentativo di phishing per credenziali Amazon</small></p>
                        </div>
                        
                        <div class="alert alert-warning bg-warning text-dark">
                            <h5 class="alert-heading fw-bold"><i class="fas fa-exclamation-triangle me-2"></i>Cosa cercare nel codice JavaScript</h5>
                            <p>Nel codice JavaScript estratto, cerca:</p>
                            <ul class="mb-0">
                                <li>Funzioni sospette come <code class="bg-dark text-white px-1">eval()</code>, <code class="bg-dark text-white px-1">unescape()</code></li>
                                <li>Stringhe offuscate con lunghe sequenze esadecimali</li>
                                <li>Codice che tenta di eseguire download o chiamate HTTP</li>
                                <li>Funzioni che sfruttano vulnerabilità note come heap spray</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h4>Altri strumenti per l'analisi di PDF</h4>
                    </div>
                    <div class="card-body">
                        <ul>
                            <li>
                                <strong>PDFiD</strong>
                                <pre><code class="language-bash">pdfid.py file.pdf</code></pre>
                                <p>Identifica rapidamente elementi sospetti in un file PDF, come JavaScript, azioni automatiche, o caratteristiche tipiche di exploit.</p>
                            </li>
                            <li>
                                <strong>pdf-parser</strong>
                                <pre><code class="language-bash">pdf-parser.py --search JavaScript file.pdf</code></pre>
                                <p>Cerca specifici elementi all'interno di un PDF, utile per trovare codice offuscato o nascosto.</p>
                            </li>
                            <li>
                                <strong>pdfexaminer.com</strong>
                                <p>Servizio online che permette di caricare e analizzare un file PDF, fornendo un report dettagliato su potenziali minacce.</p>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="card mb-4 border-primary">
                    <div class="card-header bg-primary text-white">
                        <h4 class="mb-0"><i class="fas fa-clipboard-check me-2"></i>Playbook di Analisi PDF</h4>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5 class="border-bottom pb-2">Raccolta Informazioni</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item border-0 ps-0">
                                        <strong>Identificazione del tipo di file:</strong>
                                        <ul>
                                            <li><code>file &lt;documento&gt;</code> → Verifica estensione e integrità</li>
                                            <li><code>exiftool &lt;documento&gt;</code> → Analisi dei metadati</li>
                                        </ul>
                                    </li>
                                    <li class="list-group-item border-0 ps-0">
                                        <strong>Hashing e identificazione:</strong>
                                        <ul>
                                            <li><code>sha256sum &lt;documento&gt;</code> → Calcolo dell'hash</li>
                                            <li>Verifica su VirusTotal, Malshare, Hybrid Analysis</li>
                                        </ul>
                                    </li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h5 class="border-bottom pb-2">Analisi Statica PDF</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item border-0 ps-0">
                                        <code>pdfid &lt;documento.pdf&gt;</code> → Identifica oggetti sospetti
                                    </li>
                                    <li class="list-group-item border-0 ps-0">
                                        <code>pdf-parser -o 1 &lt;documento.pdf&gt;</code> → Estrae e analizza oggetti specifici
                                    </li>
                                    <li class="list-group-item border-0 ps-0">
                                        <code>peepdf</code> → GUI interattiva per navigare nel PDF
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Aggiungi il JavaScript specifico per le tab di Malware Analysis -->
<script src="menu_malware.js"></script>
<div class="row">
    <div class="col-lg-8">
        <h1 class="section-title">Piattaforme SIEM</h1>
        
        <div class="card mb-4">
            <div class="card-body">
                <p>
                    I <strong>Security Information and Event Management</strong> (SIEM) sono strumenti fondamentali per ogni SOC. Queste piattaforme raccolgono, normalizzano e correlano dati provenienti da diverse fonti per identificare potenziali minacce alla sicurezza.
                </p>
                <p>
                    In questa sezione, esploreremo le principali piattaforme SIEM utilizzate nel nostro ambiente:
                </p>
                
                <ul class="nav nav-tabs" id="siemTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link siem-tab active" id="splunk-tab" data-bs-toggle="tab" data-bs-target="#splunk" type="button" role="tab" aria-controls="splunk" aria-selected="true" data-target="splunk">
                            <i class="fas fa-bolt me-1"></i> Splunk
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link siem-tab" id="elastic-tab" data-bs-toggle="tab" data-bs-target="#elastic" type="button" role="tab" aria-controls="elastic" aria-selected="false" data-target="elastic">
                            <i class="fas fa-search me-1"></i> Elastic Security
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link siem-tab" id="defender-tab" data-bs-toggle="tab" data-bs-target="#defender" type="button" role="tab" aria-controls="defender" aria-selected="false" data-target="defender">
                            <i class="fas fa-shield-alt me-1"></i> Microsoft Defender
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link siem-tab" id="qradar-tab" data-bs-toggle="tab" data-bs-target="#qradar" type="button" role="tab" aria-controls="qradar" aria-selected="false" data-target="qradar">
                            <i class="fas fa-eye me-1"></i> IBM QRadar
                        </button>
                    </li>
                </ul>
                
                <div class="tab-content" id="siemTabContent">
                    <!-- Splunk -->
                    <div class="tab-pane fade show active siem-content" id="splunk" role="tabpanel" aria-labelledby="splunk-tab">
                        <div class="p-3">
                            <h3>Splunk</h3>
                            <p>
                                Splunk è una delle piattaforme SIEM più diffuse, nota per la sua potente capacità di ricerca e analisi di grandi volumi di dati. Splunk utilizza il linguaggio SPL (Search Processing Language) per interrogare i dati.
                            </p>
                            
                            <h4 class="mt-4">Sintassi di base</h4>
                            <p>
                                SPL è un linguaggio potente che utilizza pipe (<code>|</code>) per concatenare comandi. La struttura base di una query Splunk è:
                            </p>
                            <pre><code class="language-sql">index="nome_index" sourcetype="nome_sourcetype" | comando1 | comando2 | ...</code></pre>
                            
                            <div class="note mt-3">
                                <strong>Nota:</strong> La ricerca inizia sempre con l'indicazione della fonte dati (index, sourcetype), seguita da filtri e comandi di elaborazione.
                            </div>
                            
                            <h4 class="mt-4">Comandi principali</h4>
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-terminal me-2"></i><strong>stats</strong>
                                </div>
                                <div class="card-body">
                                    <p>Utilizzato per calcolare statistiche sui dati:</p>
                                    <pre><code class="language-sql">index="windows" sourcetype="WinEventLog:Security" EventCode=4625 
| stats count by src_ip, user</code></pre>
                                    <p>
                                        Questo comando conta i tentativi di accesso falliti (EventCode 4625) raggruppati per indirizzo IP di origine e nome utente.
                                    </p>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-terminal me-2"></i><strong>eval</strong>
                                </div>
                                <div class="card-body">
                                    <p>Crea o modifica campi in base a espressioni:</p>
                                    <pre><code class="language-sql">index="firewall" action=blocked 
| eval risk_score=case(
    country="Russia" OR country="China", 90,
    bytes>10000000, 70,
    true(), 50)
| table src_ip, country, bytes, risk_score</code></pre>
                                    <p>
                                        Questa query assegna un punteggio di rischio in base al paese di origine e alla quantità di dati trasferiti.
                                    </p>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-terminal me-2"></i><strong>rex</strong>
                                </div>
                                <div class="card-body">
                                    <p>Estrae informazioni utilizzando espressioni regolari:</p>
                                    <pre><code class="language-sql">index="proxy" 
| rex field=url "(?<domain>[^/]+)"
| stats count by domain
| sort -count</code></pre>
                                    <p>
                                        Estrae il dominio dagli URL e conta le occorrenze, ordinando per conteggio decrescente.
                                    </p>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-terminal me-2"></i><strong>lookup</strong>
                                </div>
                                <div class="card-body">
                                    <p>Arricchisce i dati con informazioni da tabelle esterne:</p>
                                    <pre><code class="language-sql">index="network" src_ip=* 
| lookup ip_to_threat_intel src_ip as ip
| where isnotnull(threat_category)
| table src_ip, threat_category, threat_score</code></pre>
                                    <p>
                                        Arricchisce gli IP con informazioni di threat intelligence da una tabella di lookup.
                                    </p>
                                </div>
                            </div>
                            
                            <h4 class="mt-4">Esempi pratici</h4>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-user-secret me-2"></i><strong>Individuare login sospetti</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">index=authentication sourcetype=*login* 
| bucket span=1h _time 
| stats count as login_attempts by _time, user, src_ip
| eventstats avg(login_attempts) as avg_attempts, stdev(login_attempts) as stdev_attempts by user
| where login_attempts > avg_attempts+(stdev_attempts*3)
| sort -login_attempts</code></pre>
                                    <p>
                                        Questa query identifica accessi anomali basandosi su deviazioni standard rispetto al comportamento storico dell'utente.
                                    </p>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-cloud-upload-alt me-2"></i><strong>Identificare esfiltrazione dati</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">index="network" sourcetype="firewall" 
| stats sum(bytes_out) as total_bytes by src_ip, dest_ip
| where total_bytes > 500000000
| lookup asset_list src_ip
| lookup ip_reputation dest_ip
| where asset_criticality="high" AND reputation_score > 70
| sort -total_bytes</code></pre>
                                    <p>
                                        Individua grandi volumi di dati trasferiti da asset critici verso IP con reputazione sospetta.
                                    </p>
                                </div>
                            </div>
                            
                            <h4 class="mt-4">Creazione di dashboard e alert</h4>
                            <p>
                                Per creare un alert in Splunk:
                            </p>
                            <ol>
                                <li>Salvare la ricerca con "Save As > Alert"</li>
                                <li>Definire la schedulazione (ogni ora, giorno, ecc.)</li>
                                <li>Impostare le condizioni di trigger (es. risultati > 0)</li>
                                <li>Configurare azioni (email, webhook, creazione di ticket)</li>
                            </ol>
                            
                            <div class="alert info mt-3">
                                <i class="fas fa-lightbulb me-2"></i> <strong>Consiglio:</strong> Testa sempre le tue query prima di creare alert per evitare falsi positivi. Inizia con soglie conservative e affina nel tempo.
                            </div>
                        </div>
                    </div>
                    
                    <!-- Elastic Security -->
                    <div class="tab-pane fade siem-content" id="elastic" role="tabpanel" aria-labelledby="elastic-tab">
                        <div class="p-3">
                            <h3>Elastic Security</h3>
                            <p>
                                Elastic Security è una soluzione integrata nella piattaforma Elastic Stack (precedentemente noto come ELK Stack). Utilizza due linguaggi di query principali: Elasticsearch Query DSL (struttura JSON) e KQL (Kibana Query Language).
                            </p>
                            
                            <h4 class="mt-4">Query DSL e KQL</h4>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-terminal me-2"></i><strong>Kibana Query Language (KQL)</strong>
                                </div>
                                <div class="card-body">
                                    <p>KQL è un linguaggio più leggibile e semplice rispetto a Query DSL:</p>
                                    <pre><code class="language-sql">process.name:"powershell.exe" and command_line:(*DownloadString* or *IEX*)</code></pre>
                                    <p>
                                        Cerca processi PowerShell che contengono funzioni comunemente utilizzate in attacchi, come DownloadString o IEX (Invoke-Expression).
                                    </p>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-terminal me-2"></i><strong>Query DSL (JSON)</strong>
                                </div>
                                <div class="card-body">
                                    <p>DSL è più verboso ma offre maggiore flessibilità:</p>
                                    <pre><code class="language-json">{
  "query": {
    "bool": {
      "must": [
        { "match": { "event.category": "process" } },
        { "match": { "process.name": "cmd.exe" } }
      ],
      "filter": [
        { "range": { "@timestamp": { "gte": "now-1h" } } }
      ]
    }
  }
}</code></pre>
                                    <p>
                                        Cerca eventi di processo relativi a cmd.exe nelle ultime ore.
                                    </p>
                                </div>
                            </div>
                            
                            <h4 class="mt-4">Regole predefinite e personalizzate</h4>
                            <p>
                                Elastic Security include centinaia di regole predefinite basate su framework MITRE ATT&CK. Puoi anche creare regole personalizzate:
                            </p>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-shield-alt me-2"></i><strong>Esempio di regola (Esecuzione PowerShell sospetta)</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">process.name:powershell.exe AND process.command_line:(*-enc* OR *-EncodedCommand* OR *-e* OR *FromBase64String*) AND NOT user.name:(*admin* OR *amministratore*)</code></pre>
                                    <p>
                                        Questa regola rileva l'uso di comandi PowerShell codificati (spesso usati per offuscamento) da parte di utenti non amministratori.
                                    </p>
                                </div>
                            </div>
                            
                            <h4 class="mt-4">Hunting con campi specifici</h4>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-search me-2"></i><strong>process.name</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">process.name:(certutil.exe OR bitsadmin.exe OR regsvr32.exe OR mshta.exe OR cmstp.exe) AND NOT user.name:(*admin* OR *amministratore*)</code></pre>
                                    <p>
                                        Cerca l'esecuzione di binari Microsoft legittimi spesso abusati da attori malevoli (LOLBins) da parte di utenti non privilegiati.
                                    </p>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-search me-2"></i><strong>file.path</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">file.path:(/temp/ OR /tmp/ OR /downloads/) AND file.extension:(exe OR dll OR ps1 OR vbs OR js)</code></pre>
                                    <p>
                                        Identifica file eseguibili o script salvati in cartelle temporanee, un comportamento comune del malware.
                                    </p>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-search me-2"></i><strong>event.action</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">event.action:("user account created" OR "added to group") AND destination.user.group.name:(*admin* OR *amministrator*)</code></pre>
                                    <p>
                                        Monitora la creazione di account utente o aggiunte a gruppi amministrativi, potenziale indicatore di privilege escalation.
                                    </p>
                                </div>
                            </div>
                            
                            <div class="alert warning mt-3">
                                <i class="fas fa-exclamation-triangle me-2"></i> <strong>Attenzione:</strong> Le regole generiche possono generare molti falsi positivi. È importante personalizzarle in base all'ambiente specifico e ai comportamenti normali dell'organizzazione.
                            </div>
                        </div>
                    </div>
                    
                    <!-- Microsoft Defender -->
                    <div class="tab-pane fade siem-content" id="defender" role="tabpanel" aria-labelledby="defender-tab">
                        <div class="p-3">
                            <h3>Microsoft Defender 360</h3>
                            <p>
                                Microsoft Defender for Endpoint (precedentemente ATP) integrato con Microsoft 365 Defender offre funzionalità avanzate di rilevamento e risposta. La funzionalità Advanced Hunting utilizza KQL (Kusto Query Language) per interrogare i dati.
                            </p>
                            
                            <h4 class="mt-4">Uso di Advanced Hunting con KQL</h4>
                            <p>
                                Advanced Hunting ti permette di cercare minacce in un dataset che copre fino a 30 giorni di dati. Le query utilizzano tabelle specifiche come DeviceProcessEvents, DeviceFileEvents, ecc.
                            </p>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-terminal me-2"></i><strong>Struttura base KQL</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">NomeTabella
| where Colonna == "Valore"
| project Colonna1, Colonna2
| limit 100</code></pre>
                                    <p>
                                        La sintassi è simile a quella di Splunk, ma usa pipe (|) per separare le operazioni, "where" per filtrare e "project" per selezionare le colonne.
                                    </p>
                                </div>
                            </div>
                            
                            <h4 class="mt-4">Query per file sospetti</h4>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-file me-2"></i><strong>File eseguibili in cartelle insolite</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">DeviceFileEvents
| where Timestamp > ago(7d)
| where FolderPath startswith "C:\\Users" 
  and FolderPath contains "\\AppData\\Local\\Temp\\" 
  and (FileName endswith ".exe" or FileName endswith ".dll")
| project Timestamp, DeviceName, ActionType, FileName, FolderPath, SHA1, InitiatingProcessCommandLine
| order by Timestamp desc</code></pre>
                                    <p>
                                        Identifica file eseguibili o DLL salvati nelle cartelle temporanee degli utenti negli ultimi 7 giorni.
                                    </p>
                                </div>
                            </div>
                            
                            <h4 class="mt-4">Esecuzioni anomale</h4>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-running me-2"></i><strong>Processi con linee di comando sospette</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">DeviceProcessEvents
| where Timestamp > ago(1d)
| where FileName in~ ("powershell.exe", "cmd.exe", "wscript.exe", "cscript.exe")
| where ProcessCommandLine contains "hidden" 
   or ProcessCommandLine contains "bypass" 
   or ProcessCommandLine contains "-enc" 
   or ProcessCommandLine contains "-w hidden" 
   or ProcessCommandLine contains "IEX"
| project Timestamp, DeviceName, FileName, ProcessCommandLine, AccountName
| order by Timestamp desc</code></pre>
                                    <p>
                                        Rileva comandi di PowerShell o cmd potenzialmente dannosi che utilizzano tecniche di offuscamento o bypass.
                                    </p>
                                </div>
                            </div>
                            
                            <h4 class="mt-4">PowerShell sospetto</h4>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-terminal me-2"></i><strong>Download e esecuzione remota</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">DeviceProcessEvents
| where Timestamp > ago(7d)
| where FileName =~ "powershell.exe"
| where ProcessCommandLine has_any("wget", "curl", "Invoke-WebRequest", "Net.WebClient", "Start-BitsTransfer", "DownloadFile")
| where ProcessCommandLine has_any("IEX", "Invoke-Expression", "-e ", "-enc", "-EncodedCommand")
| project Timestamp, DeviceName, InitiatingProcessFileName, ProcessCommandLine, AccountName
| order by Timestamp desc</code></pre>
                                    <p>
                                        Questa query identifica scenari in cui PowerShell viene utilizzato per scaricare contenuto da Internet e poi eseguirlo direttamente in memoria, una tecnica comune nei malware "fileless".
                                    </p>
                                </div>
                            </div>
                            
                            <h4 class="mt-4">Esempi pratici di indagine</h4>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-search me-2"></i><strong>Tracciare la catena di esecuzione completa</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">// Inizia da un processo sospetto identificato
let suspiciousProcess = DeviceProcessEvents
| where ProcessCommandLine contains "sospetto"
| limit 1;
// Trova il processo genitore
let parentProcess = DeviceProcessEvents
| where ProcessId in (suspiciousProcess | project InitiatingProcessId)
| project ProcessId, FileName, ProcessCommandLine;
// Trova tutti i processi figli
let childProcesses = DeviceProcessEvents
| where InitiatingProcessId in (suspiciousProcess | project ProcessId)
| project ProcessId, FileName, ProcessCommandLine;
// Unisci i risultati per visualizzare l'intera catena
parentProcess
| union suspiciousProcess
| union childProcesses
| order by Timestamp asc</code></pre>
                                    <p>
                                        Questo approccio permette di visualizzare l'intera catena di esecuzione, dal processo genitore ai processi figli, utile per comprendere il contesto completo di un'attività sospetta.
                                    </p>
                                </div>
                            </div>
                            
                            <div class="alert info mt-3">
                                <i class="fas fa-lightbulb me-2"></i> <strong>Consiglio:</strong> Utilizza il portale Microsoft 365 Defender per creare regole di rilevamento personalizzate basate sulle tue query di Advanced Hunting. Le regole possono essere configurate per generare automaticamente incidenti, avvisi o eseguire azioni di risposta.
                            </div>
                        </div>
                    </div>
                    
                    <!-- IBM QRadar -->
                    <div class="tab-pane fade siem-content" id="qradar" role="tabpanel" aria-labelledby="qradar-tab">
                        <div class="p-3">
                            <h3>IBM QRadar</h3>
                            <p>
                                IBM QRadar è una piattaforma SIEM enterprise che utilizza AQL (Ariel Query Language) per interrogare i dati. QRadar è noto per le sue capacità di analisi comportamentale e correlazione avanzata degli eventi.
                            </p>
                            
                            <h4 class="mt-4">Uso di AQL (Advanced Query Language)</h4>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-terminal me-2"></i><strong>Struttura base AQL</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">SELECT * FROM events 
WHERE "logSourceName"='Windows Authentication' 
AND "eventID"='4625' 
LAST 24 HOURS</code></pre>
                                    <p>
                                        Questa query cerca eventi di autenticazione fallita da sistemi Windows nelle ultime 24 ore.
                                    </p>
                                </div>
                            </div>
                            
                            <h4 class="mt-4">Casi d'uso</h4>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-bug me-2"></i><strong>Rilevamento Malware</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">SELECT sourceip, destinationip, userName, COUNT(*) as hitCount
FROM events 
WHERE "categoryname"='Malware' 
AND "deviceType"='AV' 
AND eventDirection='L2R' 
GROUP BY sourceip, destinationip, userName
HAVING hitCount > 5
LAST 1 HOURS</code></pre>
                                    <p>
                                        Identifica host con più rilevamenti di malware nell'ultima ora, indice di una possibile infezione attiva.
                                    </p>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-network-wired me-2"></i><strong>C2 Traffic</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">SELECT DATEFORMAT(starttime,'yyyy-MM-dd HH:mm:ss') as time_stamp,
sourceip, destinationip, destinationport, protocolname,
SUM(eventcount) as eventCount
FROM flows
WHERE destinationip IN (
    SELECT destinationip FROM reference_data.table('C2_IPs')
)
GROUP BY time_stamp, sourceip, destinationip, destinationport, protocolname
ORDER BY time_stamp DESC
LAST 48 HOURS</code></pre>
                                    <p>
                                        Monitora le comunicazioni verso IP noti come server di Command & Control (C2) utilizzando tabelle di riferimento in QRadar.
                                    </p>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header">
                                    <i class="fas fa-user-secret me-2"></i><strong>User Behavior</strong>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-sql">SELECT userName, sourceip, COUNT(DISTINCT destinationip) as uniqueDestinations
FROM events
WHERE "categoryname" = 'Authentication'
AND QIDNAME(qid) ILIKE '%success%'
GROUP BY userName, sourceip
HAVING uniqueDestinations > 20
ORDER BY uniqueDestinations DESC
LAST 24 HOURS</code></pre>
                                    <p>
                                        Identifica utenti che si autenticano su un numero anomalo di sistemi diversi, potenziale indicatore di credential stuffing o movimento laterale.
                                    </p>
                                </div>
                            </div>
                            
                            <h4 class="mt-4">Creazione di offenses custom</h4>
                            <p>
                                In QRadar, un "offense" è un incidente di sicurezza che richiede indagine. Puoi creare regole personalizzate che generano offenses automaticamente:
                            </p>
                            
                            <ol>
                                <li>Accedi alla sezione "Rules" dalla console QRadar</li>
                                <li>Seleziona "Actions" > "New Rule Wizard"</li>
                                <li>Scegli "Rules that detect events from the event viewer"</li>
                                <li>Definisci i criteri di test (es. evento con determinato QID)</li>
                                <li>Imposta risposte automatizzate e azioni di notifica</li>
                                <li>Definisci la gravità dell'offense e la categoria MITRE</li>
                            </ol>
                            
                            <div class="card mt-3">
                                <div class="card-header">
                                    <i class="fas fa-code me-2"></i><strong>Esempio di regola</strong>
                                </div>
                                <div class="card-body">
                                    <p><strong>Nome:</strong> Multipli tentativi falliti di autenticazione amministrativa</p>
                                    <p><strong>Descrizione:</strong> Rileva possibili attacchi di brute force verso account privilegiati</p>
                                    <p><strong>Condizioni:</strong></p>
                                    <ul>
                                        <li>Evento con QID in [12504, 12505, 12506] (Login falliti)</li>
                                        <li>Username contiene "admin" o "root" o "administrator"</li>
                                        <li>Stesso IP di origine</li>
                                        <li>Conteggio > 5 in 10 minuti</li>
                                    </ul>
                                    <p><strong>Risposta:</strong> Crea offense di livello "Alto" con categoria MITRE "Credential Access"</p>
                                </div>
                            </div>
                            
                            <div class="alert info mt-3">
                                <i class="fas fa-lightbulb me-2"></i> <strong>Consiglio:</strong> QRadar supporta l'integrazione con IBM X-Force Exchange per l'arricchimento automatico con threat intelligence. Utilizza i Reference Set per memorizzare e aggiornare dinamicamente le liste di IOC.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <div class="sidebar">
            <h4><i class="fas fa-info-circle me-2"></i>Risorse SIEM</h4>
            <div class="card mb-3">
                <div class="card-body">
                    <h5>Concetti fondamentali</h5>
                    <ul class="list-unstyled">
                        <li><i class="fas fa-check-circle me-2 text-success"></i>Normalizzazione dei log</li>
                        <li><i class="fas fa-check-circle me-2 text-success"></i>Correlazione degli eventi</li>
                        <li><i class="fas fa-check-circle me-2 text-success"></i>Analisi comportamentale</li>
                        <li><i class="fas fa-check-circle me-2 text-success"></i>Threat Intelligence</li>
                    </ul>
                </div>
            </div>
            
            <div class="card mb-4">
                <div class="card-header">
                    <i class="fas fa-lightbulb me-2"></i>Best Practice
                </div>
                <div class="card-body">
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="fas fa-angle-right me-2"></i><strong>Contestualizza gli alert</strong> - Correla con altre fonti di dati per ridurre i falsi positivi.</li>
                        <li class="mb-2"><i class="fas fa-angle-right me-2"></i><strong>Tuning continuo</strong> - Refina regolarmente le regole in base ai risultati e ai feedback.</li>
                        <li class="mb-2"><i class="fas fa-angle-right me-2"></i><strong>Baseline l'ambiente</strong> - Comprendi il comportamento normale prima di cercare le anomalie.</li>
                        <li class="mb-2"><i class="fas fa-angle-right me-2"></i><strong>Automatizza</strong> - Usa playbook per le attività ripetitive di investigazione.</li>
                    </ul>
                </div>
            </div>
            
            <div class="card mb-4">
                <div class="card-header">
                    <i class="fas fa-exclamation-triangle me-2"></i>Errori comuni
                </div>
                <div class="card-body">
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="fas fa-times-circle me-2 text-danger"></i><strong>Query troppo generiche</strong> che generano un eccesso di falsi positivi.</li>
                        <li class="mb-2"><i class="fas fa-times-circle me-2 text-danger"></i><strong>Ignorare il contesto</strong> delle attività rilevate.</li>
                        <li class="mb-2"><i class="fas fa-times-circle me-2 text-danger"></i><strong>Non documentare</strong> le indagini e le decisioni prese.</li>
                        <li class="mb-2"><i class="fas fa-times-circle me-2 text-danger"></i><strong>Alert fatigue</strong> - Essere sopraffatti dal volume di alert.</li>
                    </ul>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-graduation-cap me-2"></i>Approfondimenti
                </div>
                <div class="card-body">
                    <p>Per migliorare ulteriormente le tue competenze SIEM:</p>
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="fas fa-external-link-alt me-2"></i><a href="#" class="text-primary">Documentazione ufficiale Splunk</a></li>
                        <li class="mb-2"><i class="fas fa-external-link-alt me-2"></i><a href="#" class="text-primary">Elastic Security Labs</a></li>
                        <li class="mb-2"><i class="fas fa-external-link-alt me-2"></i><a href="#" class="text-primary">Microsoft Defender Hunting Queries</a></li>
                        <li class="mb-2"><i class="fas fa-external-link-alt me-2"></i><a href="#" class="text-primary">QRadar Use Cases Library</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

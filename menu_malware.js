document.addEventListener('DOMContentLoaded', function() {
    // Verifica e inizializza le tab del malware
    checkForMalwareTabs();
});

function checkForMalwareTabs() {
    // Controlla se esistono tab per il malware nella pagina
    if (document.getElementById('malwareTabs')) {
        initMalwareTabs();
    } else {
        // Se non ci sono ancora, ricontrolla tra poco
        setTimeout(checkForMalwareTabs, 100);
    }
}

function initMalwareTabs() {
    // Gestisce il click sulle tab del malware
    const tabs = document.querySelectorAll('#malwareTabs .nav-link');
    tabs.forEach(tab => {
        tab.addEventListener('click', function(e) {
            e.preventDefault();
            loadMalwareContent(this.id.replace('-tab', ''));
        });
    });

    // Carica la prima tab di default
    const activeTab = document.querySelector('#malwareTabs .nav-link.active');
    if (activeTab) {
        loadMalwareContent(activeTab.id.replace('-tab', ''));
    }
}

function loadMalwareContent(section) {
    // Rimuove active class da tutte le tab
    document.querySelectorAll('#malwareTabs .nav-link').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Nasconde tutti i pane
    document.querySelectorAll('#malwareTabContent .tab-pane').forEach(pane => {
        pane.classList.remove('show', 'active');
    });
    
    // Attiva la tab selezionata
    const selectedTab = document.getElementById(section + '-tab');
    if (selectedTab) {
        selectedTab.classList.add('active');
    }
    
    // Mostra il pane selezionato
    const selectedPane = document.getElementById(section);
    if (selectedPane) {
        selectedPane.classList.add('show', 'active');
    }
    
    // Inizializza syntax highlighting per il codice
    document.querySelectorAll('pre code').forEach((block) => {
        hljs.highlightElement(block);
    });
}